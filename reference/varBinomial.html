<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Testing, Confidence Intervals, Sample Size and Power for Comparing Two
Binomial Rates — ciBinomial • gsDesign</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Testing, Confidence Intervals, Sample Size and Power for Comparing Two
Binomial Rates — ciBinomial" />
<meta property="og:description" content="Support is provided for sample size estimation, power, testing, confidence
intervals and simulation for fixed sample size trials (that is, not group
sequential or adaptive) with two arms and binary outcomes.  Both superiority
and non-inferiority trials are considered. While all routines default to
comparisons of risk-difference, options to base computations on risk-ratio
and odds-ratio are also included.
nBinomial() computes sample size or power using the method of
Farrington and Manning (1990) for a trial to test the difference between two
binomial event rates.  The routine can be used for a test of superiority or
non-inferiority. For a design that tests for superiority nBinomial()
is consistent with the method of Fleiss, Tytun, and Ury (but without the
continuity correction) to test for differences between event rates. This
routine is consistent with the Hmisc package routines bsamsize and
bpower for superiority designs. Vector arguments allow computing
sample sizes for multiple scenarios for comparative purposes.
testBinomial() computes a Z- or Chi-square-statistic that compares
two binomial event rates using the method of Miettinen and Nurminen (1980).
This can be used for superiority or non-inferiority testing. Vector
arguments allow easy incorporation into simulation routines for fixed, group
sequential and adaptive designs.
ciBinomial() computes confidence intervals for 1) the difference
between two rates, 2) the risk-ratio for two rates or 3) the odds-ratio for
two rates. This procedure provides inference that is consistent with
testBinomial() in that the confidence intervals are produced by
inverting the testing procedures in testBinomial(). The Type I error
alpha input to ciBinomial is always interpreted as 2-sided.
simBinomial() performs simulations to estimate the power for a
Miettinen and Nurminen (1985) test comparing two binomial rates for
superiority or non-inferiority.  As noted in documentation for
bpower.sim() in the HMisc package, by using testBinomial() you
can see that the formulas without any continuity correction are quite
accurate.  In fact, Type I error for a continuity-corrected test is
significantly lower (Gordon and Watson, 1996) than the nominal rate.  Thus,
as a default no continuity corrections are performed.
varBinomial computes blinded estimates of the variance of the
estimate of 1) event rate differences, 2) logarithm of the risk ratio, or 3)
logarithm of the odds ratio. This is intended for blinded sample size
re-estimation for comparative trials with a binary outcome.
Testing is 2-sided when a Chi-square statistic is used and 1-sided when a
Z-statistic is used. Thus, these 2 options will produce substantially
different results, in general. For non-inferiority, 1-sided testing is
appropriate.
You may wish to round sample sizes up using ceiling().
Farrington and Manning (1990) begin with event rates p1 and p2
under the alternative hypothesis and a difference between these rates under
the null hypothesis, delta0. From these values, actual rates under
the null hypothesis are computed, which are labeled p10 and
p20 when outtype=3. The rates p1 and p2 are used
to compute a variance for a Z-test comparing rates under the alternative
hypothesis, while p10 and p20 are used under the null
hypothesis. This computational method is also used to estimate variances in
varBinomial() based on the overall event rate observed and the input
treatment difference specified in delta0.
Sample size with scale=&quot;Difference&quot; produces an error if
p1-p2=delta0.  Normally, the alternative hypothesis under
consideration would be p1-p2-delta0$&amp;gt;0$. However, the alternative can
have p1-p2-delta0$&amp;lt;0$." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



<!-- dependencies from examples -->


  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gsDesign</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Testing, Confidence Intervals, Sample Size and Power for Comparing Two
Binomial Rates</h1>
    
    <div class="hidden name"><code>varBinomial.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Support is provided for sample size estimation, power, testing, confidence
intervals and simulation for fixed sample size trials (that is, not group
sequential or adaptive) with two arms and binary outcomes.  Both superiority
and non-inferiority trials are considered. While all routines default to
comparisons of risk-difference, options to base computations on risk-ratio
and odds-ratio are also included.</p>
<p><code><a href='varBinomial.html'>nBinomial()</a></code> computes sample size or power using the method of
Farrington and Manning (1990) for a trial to test the difference between two
binomial event rates.  The routine can be used for a test of superiority or
non-inferiority. For a design that tests for superiority <code><a href='varBinomial.html'>nBinomial()</a></code>
is consistent with the method of Fleiss, Tytun, and Ury (but without the
continuity correction) to test for differences between event rates. This
routine is consistent with the Hmisc package routines <code>bsamsize</code> and
<code>bpower</code> for superiority designs. Vector arguments allow computing
sample sizes for multiple scenarios for comparative purposes.</p>
<p><code><a href='varBinomial.html'>testBinomial()</a></code> computes a Z- or Chi-square-statistic that compares
two binomial event rates using the method of Miettinen and Nurminen (1980).
This can be used for superiority or non-inferiority testing. Vector
arguments allow easy incorporation into simulation routines for fixed, group
sequential and adaptive designs.</p>
<p><code><a href='varBinomial.html'>ciBinomial()</a></code> computes confidence intervals for 1) the difference
between two rates, 2) the risk-ratio for two rates or 3) the odds-ratio for
two rates. This procedure provides inference that is consistent with
<code><a href='varBinomial.html'>testBinomial()</a></code> in that the confidence intervals are produced by
inverting the testing procedures in <code><a href='varBinomial.html'>testBinomial()</a></code>. The Type I error
<code>alpha</code> input to <code>ciBinomial</code> is always interpreted as 2-sided.</p>
<p><code><a href='varBinomial.html'>simBinomial()</a></code> performs simulations to estimate the power for a
Miettinen and Nurminen (1985) test comparing two binomial rates for
superiority or non-inferiority.  As noted in documentation for
<code>bpower.sim()</code> in the HMisc package, by using <code><a href='varBinomial.html'>testBinomial()</a></code> you
can see that the formulas without any continuity correction are quite
accurate.  In fact, Type I error for a continuity-corrected test is
significantly lower (Gordon and Watson, 1996) than the nominal rate.  Thus,
as a default no continuity corrections are performed.</p>
<p><code>varBinomial</code> computes blinded estimates of the variance of the
estimate of 1) event rate differences, 2) logarithm of the risk ratio, or 3)
logarithm of the odds ratio. This is intended for blinded sample size
re-estimation for comparative trials with a binary outcome.</p>
<p>Testing is 2-sided when a Chi-square statistic is used and 1-sided when a
Z-statistic is used. Thus, these 2 options will produce substantially
different results, in general. For non-inferiority, 1-sided testing is
appropriate.</p>
<p>You may wish to round sample sizes up using <code><a href='https://rdrr.io/r/base/Round.html'>ceiling()</a></code>.</p>
<p>Farrington and Manning (1990) begin with event rates <code>p1</code> and <code>p2</code>
under the alternative hypothesis and a difference between these rates under
the null hypothesis, <code>delta0</code>. From these values, actual rates under
the null hypothesis are computed, which are labeled <code>p10</code> and
<code>p20</code> when <code>outtype=3</code>. The rates <code>p1</code> and <code>p2</code> are used
to compute a variance for a Z-test comparing rates under the alternative
hypothesis, while <code>p10</code> and <code>p20</code> are used under the null
hypothesis. This computational method is also used to estimate variances in
<code><a href='varBinomial.html'>varBinomial()</a></code> based on the overall event rate observed and the input
treatment difference specified in <code>delta0</code>.</p>
<p>Sample size with <code>scale="Difference"</code> produces an error if
<code>p1-p2=delta0</code>.  Normally, the alternative hypothesis under
consideration would be <code>p1-p2-delta0</code>$&gt;0$. However, the alternative can
have <code>p1-p2-delta0</code>$&lt;0$.</p>
    </div>

    <pre class="usage"><span class='fu'><a href='varBinomial.html'>ciBinomial</a></span><span class='op'>(</span><span class='va'>x1</span>, <span class='va'>x2</span>, <span class='va'>n1</span>, <span class='va'>n2</span>, alpha <span class='op'>=</span> <span class='fl'>0.05</span>, adj <span class='op'>=</span> <span class='fl'>0</span>, scale <span class='op'>=</span> <span class='st'>"Difference"</span><span class='op'>)</span>

<span class='fu'><a href='varBinomial.html'>nBinomial</a></span><span class='op'>(</span>
  <span class='va'>p1</span>,
  <span class='va'>p2</span>,
  alpha <span class='op'>=</span> <span class='fl'>0.025</span>,
  beta <span class='op'>=</span> <span class='fl'>0.1</span>,
  delta0 <span class='op'>=</span> <span class='fl'>0</span>,
  ratio <span class='op'>=</span> <span class='fl'>1</span>,
  sided <span class='op'>=</span> <span class='fl'>1</span>,
  outtype <span class='op'>=</span> <span class='fl'>1</span>,
  scale <span class='op'>=</span> <span class='st'>"Difference"</span>,
  n <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span>

<span class='fu'><a href='varBinomial.html'>simBinomial</a></span><span class='op'>(</span>
  <span class='va'>p1</span>,
  <span class='va'>p2</span>,
  <span class='va'>n1</span>,
  <span class='va'>n2</span>,
  delta0 <span class='op'>=</span> <span class='fl'>0</span>,
  nsim <span class='op'>=</span> <span class='fl'>10000</span>,
  chisq <span class='op'>=</span> <span class='fl'>0</span>,
  adj <span class='op'>=</span> <span class='fl'>0</span>,
  scale <span class='op'>=</span> <span class='st'>"Difference"</span>
<span class='op'>)</span>

<span class='fu'><a href='varBinomial.html'>testBinomial</a></span><span class='op'>(</span>
  <span class='va'>x1</span>,
  <span class='va'>x2</span>,
  <span class='va'>n1</span>,
  <span class='va'>n2</span>,
  delta0 <span class='op'>=</span> <span class='fl'>0</span>,
  chisq <span class='op'>=</span> <span class='fl'>0</span>,
  adj <span class='op'>=</span> <span class='fl'>0</span>,
  scale <span class='op'>=</span> <span class='st'>"Difference"</span>,
  tol <span class='op'>=</span> <span class='fl'>1e-11</span>
<span class='op'>)</span>

<span class='fu'><a href='varBinomial.html'>varBinomial</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>n</span>, delta0 <span class='op'>=</span> <span class='fl'>0</span>, ratio <span class='op'>=</span> <span class='fl'>1</span>, scale <span class='op'>=</span> <span class='st'>"Difference"</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x1</th>
      <td><p>Number of &#8220;successes&#8221; in the control group</p></td>
    </tr>
    <tr>
      <th>x2</th>
      <td><p>Number of &#8220;successes&#8221; in the experimental group</p></td>
    </tr>
    <tr>
      <th>n1</th>
      <td><p>Number of observations in the control group</p></td>
    </tr>
    <tr>
      <th>n2</th>
      <td><p>Number of observations in the experimental group</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>type I error; see <code>sided</code> below to distinguish between 1-
and 2-sided tests</p></td>
    </tr>
    <tr>
      <th>adj</th>
      <td><p>With <code>adj=1</code>, the standard variance with a continuity
correction is used for a Miettinen and Nurminen test statistic This includes
a factor of \(n / (n - 1)\) where \(n\) is the total sample size. If
<code>adj</code> is not 1, this factor is not applied. The default is <code>adj=0</code>
since nominal Type I error is generally conservative with <code>adj=1</code>
(Gordon and Watson, 1996).</p></td>
    </tr>
    <tr>
      <th>scale</th>
      <td><p>&#8220;Difference&#8221;, &#8220;RR&#8221;, &#8220;OR&#8221;; see the
<code>scale</code> parameter documentation above and Details.  This is a scalar
argument.</p></td>
    </tr>
    <tr>
      <th>p1</th>
      <td><p>event rate in group 1 under the alternative hypothesis</p></td>
    </tr>
    <tr>
      <th>p2</th>
      <td><p>event rate in group 2 under the alternative hypothesis</p></td>
    </tr>
    <tr>
      <th>beta</th>
      <td><p>type II error</p></td>
    </tr>
    <tr>
      <th>delta0</th>
      <td><p>A value of 0 (the default) always represents no difference
between treatment groups under the null hypothesis. <code>delta0</code> is
interpreted differently depending on the value of the parameter
<code>scale</code>.  If <code>scale="Difference"</code> (the default), <code>delta0</code> is
the difference in event rates under the null hypothesis (p10 - p20). If
<code>scale="RR"</code>, <code>delta0</code> is the logarithm of the relative risk of
event rates (p10 / p20) under the null hypothesis. If <code>scale="LNOR"</code>,
<code>delta0</code> is the difference in natural logarithm of the odds-ratio under
the null hypothesis <code>log(p10 / (1 - p10)) - log(p20 / (1 - p20))</code>.</p></td>
    </tr>
    <tr>
      <th>ratio</th>
      <td><p>sample size ratio for group 2 divided by group 1</p></td>
    </tr>
    <tr>
      <th>sided</th>
      <td><p>2 for 2-sided test, 1 for 1-sided test</p></td>
    </tr>
    <tr>
      <th>outtype</th>
      <td><p><code>nBinomial</code> only; 1 (default) returns total sample size;
2 returns a data frame with sample size for each group (<code>n1, n2</code>; if
<code>n</code> is not input as <code>NULL</code>, power is returned in <code>Power</code>; 3
returns a data frame with total sample size (<code>n</code>), sample size in each
group (<code>n1, n2</code>), Type I error (<code>alpha</code>), 1 or 2 (<code>sided</code>, as
input), Type II error (<code>beta</code>), power (<code>Power</code>), null and
alternate hypothesis standard deviations (<code>sigma0, sigma1</code>), input
event rates (<code>p1, p2</code>), null hypothesis difference in treatment group
means (<code>delta0</code>) and null hypothesis event rates (<code>p10, p20</code>).</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>If power is to be computed in <code><a href='varBinomial.html'>nBinomial()</a></code>, input total trial
sample size in <code>n</code>; this may be a vector. This is also the sample size
in <code>varBinomial</code>, in which case the argument must be a scalar.</p></td>
    </tr>
    <tr>
      <th>nsim</th>
      <td><p>The number of simulations to be performed in
<code><a href='varBinomial.html'>simBinomial()</a></code></p></td>
    </tr>
    <tr>
      <th>chisq</th>
      <td><p>An indicator of whether or not a chi-square (as opposed to Z)
statistic is to be computed. If <code>delta0=0</code> (default), the difference in
event rates divided by its standard error under the null hypothesis is used.
Otherwise, a Miettinen and Nurminen chi-square statistic for a 2 x 2 table
is used.</p></td>
    </tr>
    <tr>
      <th>tol</th>
      <td><p>Default should probably be used; this is used to deal with a
rounding issue in interim calculations</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>Number of &#8220;successes&#8221; in the combined control and
experimental groups.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code><a href='varBinomial.html'>testBinomial()</a></code> and <code><a href='varBinomial.html'>simBinomial()</a></code> each return a vector
of either Chi-square or Z test statistics.  These may be compared to an
appropriate cutoff point (e.g., <code>qnorm(.975)</code> for normal or
<code>qchisq(.95,1)</code> for chi-square).</p>
<p><code><a href='varBinomial.html'>ciBinomial()</a></code> returns a data frame with 1 row with a confidence
interval; variable names are <code>lower</code> and <code>upper</code>.</p>
<p><code><a href='varBinomial.html'>varBinomial()</a></code> returns a vector of (blinded) variance estimates of the
difference of event rates (<code>scale="Difference"</code>), logarithm of the
odds-ratio (<code>scale="OR"</code>) or logarithm of the risk-ratio
(<code>scale="RR"</code>).</p>
<p>With the default <code>outtype=1</code>, <code><a href='varBinomial.html'>nBinomial()</a></code> returns a vector of
total sample sizes is returned.  With <code>outtype=2</code>, <code><a href='varBinomial.html'>nBinomial()</a></code>
returns a data frame containing two vectors <code>n1</code> and <code>n2</code>
containing sample sizes for groups 1 and 2, respectively; if <code>n</code> is
input, this option also returns the power in a third vector, <code>Power</code>.
With <code>outtype=3</code>, <code><a href='varBinomial.html'>nBinomial()</a></code> returns a data frame with the
following columns:</p>
<dt>n</dt><dd><p>A vector with total samples size required for
each event rate comparison specified</p></dd> <dt>n1</dt><dd><p>A vector of sample sizes for
group 1 for each event rate comparison specified</p></dd> <dt>n2</dt><dd><p>A vector of
sample sizes for group 2 for each event rate comparison specified</p></dd>
<dt>alpha</dt><dd><p>As input</p></dd> <dt>sided</dt><dd><p>As input</p></dd> <dt>beta</dt><dd><p>As input; if
<code>n</code> is input, this is computed</p></dd> <dt>Power</dt><dd><p>If <code>n=NULL</code> on input,
this is <code>1-beta</code>; otherwise, the power is computed for each sample size
input</p></dd> <dt>sigma0</dt><dd><p>A vector containing the standard deviation of the
treatment effect difference under the null hypothesis times <code>sqrt(n)</code>
when <code>scale="Difference"</code> or <code>scale="OR"</code>; when <code>scale="RR"</code>,
this is the standard deviation time <code>sqrt(n)</code> for the numerator of the
Farrington-Manning test statistic <code>x1-exp(delta0)*x2</code>.</p></dd> <dt>sigma1</dt><dd><p>A
vector containing the values as <code>sigma0</code>, in this case estimated under
the alternative hypothesis.</p></dd> <dt>p1</dt><dd><p>As input</p></dd> <dt>p2</dt><dd><p>As input</p></dd>
<dt>p10</dt><dd><p>group 1 event rate used for null hypothesis</p></dd> <dt>p20</dt><dd><p>group 2
event rate used for null hypothesis</p></dd>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Farrington, CP and Manning, G (1990), Test statistics and sample
size formulae for comparative binomial trials with null hypothesis of
non-zero risk difference or non-unity relative risk. <em>Statistics in
Medicine</em>; 9: 1447-1454.</p>
<p>Fleiss, JL, Tytun, A and Ury (1980), A simple approximation for calculating
sample sizes for comparing independent proportions.
<em>Biometrics</em>;36:343-346.</p>
<p>Gordon, I and Watson R (1985), The myth of continuity-corrected sample size
formulae. <em>Biometrics</em>; 52: 71-76.</p>
<p>Miettinen, O and Nurminen, M (1985), Comparative analysis of two rates.
<em>Statistics in Medicine</em>; 4 : 213-226.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/r/stats/Normal.html'>Normal</a></code>,<code><a href='https://rdrr.io/r/stats/uniroot.html'>uniroot</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Keaven Anderson <a href='mailto:keaven\_anderson@merck.com'>keaven\_anderson@merck.com</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># Compute z-test test statistic comparing 39/500 to 13/500</span>
<span class='co'># use continuity correction in variance</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='varBinomial.html'>testBinomial</a></span><span class='op'>(</span>x1 <span class='op'>=</span> <span class='fl'>39</span>, x2 <span class='op'>=</span> <span class='fl'>13</span>, n1 <span class='op'>=</span> <span class='fl'>500</span>, n2 <span class='op'>=</span> <span class='fl'>500</span>, adj <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
<span class='va'>x</span>
</div><div class='co'>#&gt; [1] 3.701266</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>pnorm</a></span><span class='op'>(</span><span class='va'>x</span>, lower.tail <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='co'>#&gt; [1] 0.0001072634</div><div class='input'>
<span class='co'># Compute with unadjusted variance</span>
<span class='va'>x0</span> <span class='op'>&lt;-</span> <span class='fu'><a href='varBinomial.html'>testBinomial</a></span><span class='op'>(</span>x1 <span class='op'>=</span> <span class='fl'>39</span>, x2 <span class='op'>=</span> <span class='fl'>23</span>, n1 <span class='op'>=</span> <span class='fl'>500</span>, n2 <span class='op'>=</span> <span class='fl'>500</span><span class='op'>)</span>
<span class='va'>x0</span>
</div><div class='co'>#&gt; [1] 2.098083</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>pnorm</a></span><span class='op'>(</span><span class='va'>x0</span>, lower.tail <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='co'>#&gt; [1] 0.0179489</div><div class='input'>
<span class='co'># Perform 50k simulations to test validity of the above</span>
<span class='co'># asymptotic p-values</span>
<span class='co'># (you may want to perform more to reduce standard error of estimate)</span>
<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/double.html'>as.double</a></span><span class='op'>(</span><span class='va'>x0</span><span class='op'>)</span> <span class='op'>&lt;=</span>
  <span class='fu'><a href='varBinomial.html'>simBinomial</a></span><span class='op'>(</span>p1 <span class='op'>=</span> <span class='fl'>.078</span>, p2 <span class='op'>=</span> <span class='fl'>.078</span>, n1 <span class='op'>=</span> <span class='fl'>500</span>, n2 <span class='op'>=</span> <span class='fl'>500</span>, nsim <span class='op'>=</span> <span class='fl'>10000</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>10000</span>
</div><div class='co'>#&gt; [1] 0.0176</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/double.html'>as.double</a></span><span class='op'>(</span><span class='va'>x0</span><span class='op'>)</span> <span class='op'>&lt;=</span>
  <span class='fu'><a href='varBinomial.html'>simBinomial</a></span><span class='op'>(</span>p1 <span class='op'>=</span> <span class='fl'>.052</span>, p2 <span class='op'>=</span> <span class='fl'>.052</span>, n1 <span class='op'>=</span> <span class='fl'>500</span>, n2 <span class='op'>=</span> <span class='fl'>500</span>, nsim <span class='op'>=</span> <span class='fl'>10000</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>10000</span>
</div><div class='co'>#&gt; [1] 0.0177</div><div class='input'>
<span class='co'># Perform a non-inferiority test to see if p2=400 / 500 is within 5% of</span>
<span class='co'># p1=410 / 500 use a z-statistic with unadjusted variance</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='varBinomial.html'>testBinomial</a></span><span class='op'>(</span>x1 <span class='op'>=</span> <span class='fl'>410</span>, x2 <span class='op'>=</span> <span class='fl'>400</span>, n1 <span class='op'>=</span> <span class='fl'>500</span>, n2 <span class='op'>=</span> <span class='fl'>500</span>, delta0 <span class='op'>=</span> <span class='op'>-</span><span class='fl'>.05</span><span class='op'>)</span>
<span class='va'>x</span>
</div><div class='co'>#&gt; [1] 2.807617</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>pnorm</a></span><span class='op'>(</span><span class='va'>x</span>, lower.tail <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='co'>#&gt; [1] 0.002495478</div><div class='input'>
<span class='co'># since chi-square tests equivalence (a 2-sided test) rather than</span>
<span class='co'># non-inferiority (a 1-sided test),</span>
<span class='co'># the result is quite different</span>
<span class='fu'><a href='https://rdrr.io/r/stats/Chisquare.html'>pchisq</a></span><span class='op'>(</span><span class='fu'><a href='varBinomial.html'>testBinomial</a></span><span class='op'>(</span>
  x1 <span class='op'>=</span> <span class='fl'>410</span>, x2 <span class='op'>=</span> <span class='fl'>400</span>, n1 <span class='op'>=</span> <span class='fl'>500</span>, n2 <span class='op'>=</span> <span class='fl'>500</span>, delta0 <span class='op'>=</span> <span class='op'>-</span><span class='fl'>.05</span>,
  chisq <span class='op'>=</span> <span class='fl'>1</span>, adj <span class='op'>=</span> <span class='fl'>1</span>
<span class='op'>)</span>, <span class='fl'>1</span>, lower.tail <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='co'>#&gt; [1] 0.005012758</div><div class='input'>
<span class='co'># now simulate the z-statistic witthout continuity corrected variance</span>
<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>qnorm</a></span><span class='op'>(</span><span class='fl'>.975</span><span class='op'>)</span> <span class='op'>&lt;=</span>
  <span class='fu'><a href='varBinomial.html'>simBinomial</a></span><span class='op'>(</span>p1 <span class='op'>=</span> <span class='fl'>.8</span>, p2 <span class='op'>=</span> <span class='fl'>.8</span>, n1 <span class='op'>=</span> <span class='fl'>500</span>, n2 <span class='op'>=</span> <span class='fl'>500</span>, nsim <span class='op'>=</span> <span class='fl'>100000</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>100000</span>
</div><div class='co'>#&gt; [1] 0.02496</div><div class='input'>
<span class='co'># compute a sample size to show non-inferiority</span>
<span class='co'># with 5% margin, 90% power</span>
<span class='fu'><a href='varBinomial.html'>nBinomial</a></span><span class='op'>(</span>p1 <span class='op'>=</span> <span class='fl'>.2</span>, p2 <span class='op'>=</span> <span class='fl'>.2</span>, delta0 <span class='op'>=</span> <span class='fl'>.05</span>, alpha <span class='op'>=</span> <span class='fl'>.025</span>, sided <span class='op'>=</span> <span class='fl'>1</span>, beta <span class='op'>=</span> <span class='fl'>.1</span><span class='op'>)</span>
</div><div class='co'>#&gt; [1] 2697.607</div><div class='input'>
<span class='co'># assuming a slight advantage in the experimental group lowers</span>
<span class='co'># sample size requirement</span>
<span class='fu'><a href='varBinomial.html'>nBinomial</a></span><span class='op'>(</span>p1 <span class='op'>=</span> <span class='fl'>.2</span>, p2 <span class='op'>=</span> <span class='fl'>.19</span>, delta0 <span class='op'>=</span> <span class='fl'>.05</span>, alpha <span class='op'>=</span> <span class='fl'>.025</span>, sided <span class='op'>=</span> <span class='fl'>1</span>, beta <span class='op'>=</span> <span class='fl'>.1</span><span class='op'>)</span>
</div><div class='co'>#&gt; [1] 4131.9</div><div class='input'>
<span class='co'># compute a sample size for comparing 15% vs 10% event rates</span>
<span class='co'># with 1 to 2 randomization</span>
<span class='fu'><a href='varBinomial.html'>nBinomial</a></span><span class='op'>(</span>p1 <span class='op'>=</span> <span class='fl'>.15</span>, p2 <span class='op'>=</span> <span class='fl'>.1</span>, beta <span class='op'>=</span> <span class='fl'>.2</span>, ratio <span class='op'>=</span> <span class='fl'>2</span>, alpha <span class='op'>=</span> <span class='fl'>.05</span><span class='op'>)</span>
</div><div class='co'>#&gt; [1] 1191.041</div><div class='input'>
<span class='co'># now look at total sample size using 1-1 randomization</span>
<span class='va'>n</span> <span class='op'>&lt;-</span> <span class='fu'><a href='varBinomial.html'>nBinomial</a></span><span class='op'>(</span>p1 <span class='op'>=</span> <span class='fl'>.15</span>, p2 <span class='op'>=</span> <span class='fl'>.1</span>, beta <span class='op'>=</span> <span class='fl'>.2</span>, alpha <span class='op'>=</span> <span class='fl'>.05</span><span class='op'>)</span>
<span class='va'>n</span>
</div><div class='co'>#&gt; [1] 1079.853</div><div class='input'><span class='co'># check if inputing sample size returns the desired power</span>
<span class='fu'><a href='varBinomial.html'>nBinomial</a></span><span class='op'>(</span>p1 <span class='op'>=</span> <span class='fl'>.15</span>, p2 <span class='op'>=</span> <span class='fl'>.1</span>, beta <span class='op'>=</span> <span class='fl'>.2</span>, alpha <span class='op'>=</span> <span class='fl'>.05</span>, n <span class='op'>=</span> <span class='va'>n</span><span class='op'>)</span>
</div><div class='co'>#&gt; [1] 0.8</div><div class='input'>
<span class='co'># re-do with alternate output types</span>
<span class='fu'><a href='varBinomial.html'>nBinomial</a></span><span class='op'>(</span>p1 <span class='op'>=</span> <span class='fl'>.15</span>, p2 <span class='op'>=</span> <span class='fl'>.1</span>, beta <span class='op'>=</span> <span class='fl'>.2</span>, alpha <span class='op'>=</span> <span class='fl'>.05</span>, outtype <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</div><div class='co'>#&gt;         n1       n2
#&gt; 1 539.9264 539.9264</div><div class='input'><span class='fu'><a href='varBinomial.html'>nBinomial</a></span><span class='op'>(</span>p1 <span class='op'>=</span> <span class='fl'>.15</span>, p2 <span class='op'>=</span> <span class='fl'>.1</span>, beta <span class='op'>=</span> <span class='fl'>.2</span>, alpha <span class='op'>=</span> <span class='fl'>.05</span>, outtype <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
</div><div class='co'>#&gt;          n       n1       n2 alpha sided beta Power    sigma0    sigma1   p1
#&gt; 1 1079.853 539.9264 539.9264  0.05     1  0.2   0.8 0.6614378 0.6595453 0.15
#&gt;    p2 delta0   p10   p20
#&gt; 1 0.1      0 0.125 0.125</div><div class='input'>
<span class='co'># look at power plot under different control event rate and</span>
<span class='co'># relative risk reductions</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span>
</div><div class='co'>#&gt; 
#&gt; Attaching package: ‘dplyr’</div><div class='co'>#&gt; The following objects are masked from ‘package:stats’:
#&gt; 
#&gt;     filter, lag</div><div class='co'>#&gt; The following objects are masked from ‘package:base’:
#&gt; 
#&gt;     intersect, setdiff, setequal, union</div><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span>
<span class='va'>p1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>.075</span>, <span class='fl'>.2</span>, <span class='fl'>.000625</span><span class='op'>)</span>
<span class='va'>len</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>p1</span><span class='op'>)</span>
<span class='va'>p2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>p1</span> <span class='op'>*</span> <span class='fl'>.75</span>, <span class='va'>p1</span> <span class='op'>*</span> <span class='fl'>2</span><span class='op'>/</span><span class='fl'>3</span>, <span class='va'>p1</span> <span class='op'>*</span> <span class='fl'>.6</span>, <span class='va'>p1</span> <span class='op'>*</span> <span class='fl'>.5</span><span class='op'>)</span>
<span class='va'>Reduction</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"25 percent"</span>, <span class='va'>len</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"33 percent"</span>, <span class='va'>len</span><span class='op'>)</span>, 
               <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"40 percent"</span>, <span class='va'>len</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"50 percent"</span>, <span class='va'>len</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>p1 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='va'>p1</span>, <span class='fl'>4</span><span class='op'>)</span>, <span class='va'>p2</span>, <span class='va'>Reduction</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>`Sample size` <span class='op'>=</span> <span class='fu'><a href='varBinomial.html'>nBinomial</a></span><span class='op'>(</span><span class='va'>p1</span>, <span class='va'>p2</span>, beta <span class='op'>=</span> <span class='fl'>.2</span>, alpha <span class='op'>=</span> <span class='fl'>.025</span>, sided <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>df</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>p1</span>, y <span class='op'>=</span> <span class='va'>`Sample size`</span>, col <span class='op'>=</span> <span class='va'>Reduction</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Control group event rate"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/lims.html'>ylim</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>6000</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Binomial sample size computation for 80 pct power"</span><span class='op'>)</span>
</div><div class='img'><img src='varBinomial-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># compute blinded estimate of treatment effect difference</span>
<span class='va'>x1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Binomial.html'>rbinom</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>100</span>, p <span class='op'>=</span> <span class='fl'>.2</span><span class='op'>)</span>
<span class='va'>x2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Binomial.html'>rbinom</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>200</span>, p <span class='op'>=</span> <span class='fl'>.1</span><span class='op'>)</span>
<span class='co'># blinded estimate of risk difference variance</span>
<span class='fu'><a href='varBinomial.html'>varBinomial</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x1</span> <span class='op'>+</span> <span class='va'>x2</span>, n <span class='op'>=</span> <span class='fl'>300</span>, ratio <span class='op'>=</span> <span class='fl'>2</span>, delta0 <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>
</div><div class='co'>#&gt; [1] 0.001507333</div><div class='input'><span class='co'># blinded estimate of log-risk-ratio variance</span>
<span class='fu'><a href='varBinomial.html'>varBinomial</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x1</span> <span class='op'>+</span> <span class='va'>x2</span>, n <span class='op'>=</span> <span class='fl'>300</span>, ratio <span class='op'>=</span> <span class='fl'>2</span>, delta0 <span class='op'>=</span> <span class='fl'>0</span>, scale <span class='op'>=</span> <span class='st'>"RR"</span><span class='op'>)</span>
</div><div class='co'>#&gt; [1] 0.1173529</div><div class='input'><span class='co'># blinded estimate of log-odds-ratio variance</span>
<span class='fu'><a href='varBinomial.html'>varBinomial</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x1</span> <span class='op'>+</span> <span class='va'>x2</span>, n <span class='op'>=</span> <span class='fl'>300</span>, ratio <span class='op'>=</span> <span class='fl'>2</span>, delta0 <span class='op'>=</span> <span class='fl'>0</span>, scale <span class='op'>=</span> <span class='st'>"OR"</span><span class='op'>)</span>
</div><div class='co'>#&gt; [1] 0.1492702</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Keaven Anderson.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


