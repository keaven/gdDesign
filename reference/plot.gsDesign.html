<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Plots for group sequential designs — plot.gsDesign • gsDesign</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Plots for group sequential designs — plot.gsDesign" />
<meta property="og:description" content="The plot() function has been extended to work with objects returned
by gsDesign() and gsProbability().  For objects of type
gsDesign, seven types of plots are provided: z-values at boundaries
(default), power, approximate treatment effects at boundaries, conditional
power at boundaries, spending functions, expected sample size, and B-values
at boundaries. For objects of type gsProbability plots are available
for z-values at boundaries, power (default), approximate treatment effects at
boundaries, conditional power, expected sample size and B-values at
boundaries.
The intent is that many standard plot() parameters will function as
expected; exceptions to this rule exist. In particular, main, xlab,
ylab, lty, col, lwd, type, pch, cex have been tested and work for most
values of plottype; one exception is that type=&quot;l&quot; cannot be
overridden when plottype=2. Default values for labels depend on
plottype and the class of x.
Note that there is some special behavior for values plotted and returned for
power and expected sample size (ASN) plots for a gsDesign object. A
call to x&amp;lt;-gsDesign() produces power and expected sample size for
only two theta values: 0 and x$delta.  The call plot(x,
plottype=&quot;Power&quot;) (or plot(x,plottype=&quot;ASN&quot;) for a gsDesign
object produces power (expected sample size) curves and returns a
gsDesign object with theta values determined as follows.  If
theta is non-null on input, the input value(s) are used. Otherwise,
for a gsProbability object, the theta values from that object
are used. For a gsDesign object where theta is input as
NULL (the default), theta=seq(0,2,.05)*x$delta) is used.  For
a gsDesign object, the x-axis values are rescaled to
theta/x$delta and the label for the x-axis \(theta / delta\). For a
gsProbability object, the values of theta are plotted and are
labeled as \(theta\). See examples below.
Approximate treatment effects at boundaries are computed dividing the Z-values
at the boundaries by the square root of n.I at that analysis.
Spending functions are plotted for a continuous set of values from 0 to 1.
This option should not be used if a boundary is used or a pointwise spending
function is used (sfu or sfl=&quot;WT&quot;, &quot;OF&quot;, &quot;Pocock&quot; or
sfPoints).
Conditional power is computed using the function gsBoundCP().  The
default input for this routine is theta=&quot;thetahat&quot; which will compute
the conditional power at each bound using the approximate treatment effect at
that bound.  Otherwise, if the input is gsDesign object conditional
power is computed assuming theta=x$delta, the original effect size
for which the trial was planned.
Average sample number/expected sample size is computed using n.I at
each analysis times the probability of crossing a boundary at that analysis.
If no boundary is crossed at any analysis, this is counted as stopping at
the final analysis.
B-values are Z-values multiplied by sqrt(t)=sqrt(x$n.I/x$n.I[x$k]).
Thus, the expected value of a B-value at an analysis is the true value of
\(theta\) multiplied by the proportion of total planned observations at
that time. See Proschan, Lan and Wittes (2006)." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gsDesign</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plots for group sequential designs</h1>
    
    <div class="hidden name"><code>plot.gsDesign.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code><a href='https://rdrr.io/r/graphics/plot.default.html'>plot()</a></code> function has been extended to work with objects returned
by <code><a href='gsDesign.html'>gsDesign()</a></code> and <code><a href='gsProbability.html'>gsProbability()</a></code>.  For objects of type
<code>gsDesign</code>, seven types of plots are provided: z-values at boundaries
(default), power, approximate treatment effects at boundaries, conditional
power at boundaries, spending functions, expected sample size, and B-values
at boundaries. For objects of type <code>gsProbability</code> plots are available
for z-values at boundaries, power (default), approximate treatment effects at
boundaries, conditional power, expected sample size and B-values at
boundaries.</p>
<p>The intent is that many standard <code><a href='https://rdrr.io/r/graphics/plot.default.html'>plot()</a></code> parameters will function as
expected; exceptions to this rule exist. In particular, <code>main, xlab,
ylab, lty, col, lwd, type, pch, cex</code> have been tested and work for most
values of <code>plottype</code>; one exception is that <code>type="l"</code> cannot be
overridden when <code>plottype=2</code>. Default values for labels depend on
<code>plottype</code> and the class of <code>x</code>.</p>
<p>Note that there is some special behavior for values plotted and returned for
power and expected sample size (ASN) plots for a <code>gsDesign</code> object. A
call to <code>x&lt;-gsDesign()</code> produces power and expected sample size for
only two <code>theta</code> values: 0 and <code>x$delta</code>.  The call <code><a href='https://rdrr.io/r/graphics/plot.default.html'>plot(x,
plottype="Power")</a></code> (or <code>plot(x,plottype="ASN"</code>) for a <code>gsDesign</code>
object produces power (expected sample size) curves and returns a
<code>gsDesign</code> object with <code>theta</code> values determined as follows.  If
<code>theta</code> is non-null on input, the input value(s) are used. Otherwise,
for a <code>gsProbability</code> object, the <code>theta</code> values from that object
are used. For a <code>gsDesign</code> object where <code>theta</code> is input as
<code>NULL</code> (the default), <code>theta=seq(0,2,.05)*x$delta</code>) is used.  For
a <code>gsDesign</code> object, the x-axis values are rescaled to
<code>theta/x$delta</code> and the label for the x-axis \(theta / delta\). For a
<code>gsProbability</code> object, the values of <code>theta</code> are plotted and are
labeled as \(theta\). See examples below.</p>
<p>Approximate treatment effects at boundaries are computed dividing the Z-values
at the boundaries by the square root of <code>n.I</code> at that analysis.</p>
<p>Spending functions are plotted for a continuous set of values from 0 to 1.
This option should not be used if a boundary is used or a pointwise spending
function is used (<code>sfu</code> or <code>sfl="WT", "OF", "Pocock"</code> or
<code>sfPoints</code>).</p>
<p>Conditional power is computed using the function <code><a href='gsBoundCP.html'>gsBoundCP()</a></code>.  The
default input for this routine is <code>theta="thetahat"</code> which will compute
the conditional power at each bound using the approximate treatment effect at
that bound.  Otherwise, if the input is <code>gsDesign</code> object conditional
power is computed assuming <code>theta=x$delta</code>, the original effect size
for which the trial was planned.</p>
<p>Average sample number/expected sample size is computed using <code>n.I</code> at
each analysis times the probability of crossing a boundary at that analysis.
If no boundary is crossed at any analysis, this is counted as stopping at
the final analysis.</p>
<p>B-values are Z-values multiplied by <code>sqrt(t)=sqrt(x$n.I/x$n.I[x$k])</code>.
Thus, the expected value of a B-value at an analysis is the true value of
\(theta\) multiplied by the proportion of total planned observations at
that time. See Proschan, Lan and Wittes (2006).</p>
    </div>

    <pre class="usage"><span class='co'># S3 method for gsDesign</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>x</span>, plottype <span class='op'>=</span> <span class='fl'>1</span>, base <span class='op'>=</span> <span class='cn'>FALSE</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for gsProbability</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>x</span>, plottype <span class='op'>=</span> <span class='fl'>2</span>, base <span class='op'>=</span> <span class='cn'>FALSE</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>Object of class <code>gsDesign</code> for <code>plot.gsDesign()</code> or
<code>gsProbability</code> for</p>
<p><code>plot.gsProbability()</code>.</p></td>
    </tr>
    <tr>
      <th>plottype</th>
      <td><p>1=boundary plot (default for <code>gsDesign</code>),</p>
<p>2=power plot (default for <code>gsProbability</code>),</p>
<p>3=approximate treatment effect at boundaries,</p>
<p>4=conditional power at boundaries,</p>
<p>5=spending function plot (only available if <code>class(x)=="gsDesign"</code>),</p>
<p>6=expected sample size plot, and</p>
<p>7=B-values at boundaries.</p>
<p>Character values for <code>plottype</code> may also be entered: <code>"Z"</code> for
plot type 1, <code>"power"</code> for plot type 2, <code>"thetahat"</code> for plot type
3, <code>"CP"</code> for plot type 4, <code>"sf"</code> for plot type 5, <code>"ASN"</code>,
<code>"N"</code> or <code>"n"</code> for plot type 6, and <code>"B"</code>, <code>"B-val"</code> or
<code>"B-value"</code> for plot type 7.</p></td>
    </tr>
    <tr>
      <th>base</th>
      <td><p>Default is FALSE, which means ggplot2 graphics are used. If
true, base graphics are used for plotting.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>This allows many optional arguments that are standard when
calling <code>plot</code>.</p>
<p>Other arguments include:</p>
<p><code>theta</code> which is used for <code>plottype=2</code>, <code>4</code>, <code>6</code>;
normally defaults will be adequate; see details.</p>
<p><code>ses=TRUE</code> which applies only when <code>plottype=3</code> and</p>
<p><code>class(x)=="gsDesign"</code>; indicates that approximate standardized effect
size at the boundary is to be plotted rather than the approximate natural parameter.</p>
<p><code>xval="Default"</code> which is only effective when <code>plottype=2</code> or
<code>6</code>. Appropriately scaled (reparameterized) values for x-axis for power
and expected sample size graphs; see details.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of <code><a href='https://rdrr.io/r/base/class.html'>class(x)</a></code>; in many cases this is the input value
of <code>x</code>, while in others <code>x$theta</code> is replaced and corresponding
characteristics computed; see details.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>The manual is not linked to this help file, but is available in
library/gsdesign/doc/gsDesignManual.pdf in the directory where R is
installed.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Jennison C and Turnbull BW (2000), <em>Group Sequential
Methods with Applications to Clinical Trials</em>. Boca Raton: Chapman and Hall.</p>
<p>Proschan, MA, Lan, KKG, Wittes, JT (2006), <em>Statistical Monitoring of
Clinical Trials. A Unified Approach</em>.  New York: Springer.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='gsDesign.html'>gsDesign</a></code>, <code><a href='gsProbability.html'>gsProbability</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Keaven Anderson <a href='mailto:keaven\_anderson@merck.com'>keaven\_anderson@merck.com</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span>
<span class='co'>#  symmetric, 2-sided design with O'Brien-Fleming-like boundaries</span>
<span class='co'>#  lower bound is non-binding (ignored in Type I error computation)</span>
<span class='co'>#  sample size is computed based on a fixed design requiring n=100</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='gsDesign.html'>gsDesign</a></span><span class='op'>(</span>k <span class='op'>=</span> <span class='fl'>5</span>, test.type <span class='op'>=</span> <span class='fl'>2</span>, n.fix <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span>
<span class='va'>x</span>
</div><div class='output co'>#&gt; Symmetric two-sided group sequential design with
#&gt; 90 % power and 2.5 % Type I Error.
#&gt; Spending computations assume trial stops
#&gt; if a bound is crossed.
#&gt; 
#&gt;               
#&gt;   Analysis  N   Z   Nominal p  Spend
#&gt;          1  21 3.25    0.0006 0.0006
#&gt;          2  41 2.99    0.0014 0.0013
#&gt;          3  62 2.69    0.0036 0.0028
#&gt;          4  82 2.37    0.0088 0.0063
#&gt;          5 103 2.03    0.0214 0.0140
#&gt;      Total                    0.0250 
#&gt; 
#&gt; ++ alpha spending:
#&gt;  Hwang-Shih-DeCani spending function with gamma = -4.
#&gt; 
#&gt; Boundary crossing probabilities and expected sample size
#&gt; assume any cross stops the trial
#&gt; 
#&gt; Upper boundary (power or Type I Error)
#&gt;           Analysis
#&gt;    Theta      1      2      3      4      5 Total  E{N}
#&gt;   0.0000 0.0006 0.0013 0.0028 0.0063 0.0140 0.025 101.6
#&gt;   0.3242 0.0370 0.1512 0.2647 0.2699 0.1771 0.900  73.7
#&gt; 
#&gt; Lower boundary (futility or Type II Error)
#&gt;           Analysis
#&gt;    Theta     1      2      3      4     5 Total
#&gt;   0.0000 6e-04 0.0013 0.0028 0.0063 0.014 0.025
#&gt;   0.3242 0e+00 0.0000 0.0000 0.0000 0.000 0.000</div><div class='input'>
<span class='co'># the following translate to calls to plot.gsDesign since x was</span>
<span class='co'># returned by gsDesign; run these commands one at a time</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
</div><div class='img'><img src='plot.gsDesign-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>x</span>, plottype <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</div><div class='img'><img src='plot.gsDesign-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>x</span>, plottype <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
</div><div class='img'><img src='plot.gsDesign-3.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>x</span>, plottype <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span>
</div><div class='img'><img src='plot.gsDesign-4.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>x</span>, plottype <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span>
</div><div class='img'><img src='plot.gsDesign-5.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>x</span>, plottype <span class='op'>=</span> <span class='fl'>6</span><span class='op'>)</span>
</div><div class='img'><img src='plot.gsDesign-6.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>x</span>, plottype <span class='op'>=</span> <span class='fl'>7</span><span class='op'>)</span>
</div><div class='img'><img src='plot.gsDesign-7.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>#  choose different parameter values for power plot</span>
<span class='co'>#  start with design in x from above</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='gsProbability.html'>gsProbability</a></span><span class='op'>(</span>
  k <span class='op'>=</span> <span class='fl'>5</span>, theta <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>.5</span>, <span class='fl'>.025</span><span class='op'>)</span>, <span class='va'>x</span><span class='op'>$</span><span class='va'>n.I</span>,
  <span class='va'>x</span><span class='op'>$</span><span class='va'>lower</span><span class='op'>$</span><span class='va'>bound</span>, <span class='va'>x</span><span class='op'>$</span><span class='va'>upper</span><span class='op'>$</span><span class='va'>bound</span>
<span class='op'>)</span>

<span class='co'># the following translates to a call to plot.gsProbability since</span>
<span class='co'># y has that type</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span>
</div><div class='img'><img src='plot.gsDesign-8.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Keaven Anderson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


