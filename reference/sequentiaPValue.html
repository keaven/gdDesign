<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Sequential p-value computation — sequentialPValue • gsDesign</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Sequential p-value computation — sequentialPValue" />
<meta property="og:description" content="sequentialPValue computes a sequential p-value for a group sequential design using a spending function as described in 
Maurer and Bretz (2013) and previously defined by Liu and Anderson (2008).
It is the minimum of repeated p-values computed at each analysis (Jennison and Turnbull, 2000).
This is particularly useful for multiplicity methods such as the graphical method for group sequential designs 
where sequential p-values for multiple hypotheses can be used as nominal p-values to plug into a multiplicity graph. 
A sequential p-value is described as the minimum alpha level at which a one-sided group sequential bound would 
be rejected given interim and final observed results.
It is meaningful for both one-sided designs and designs with non-binding futility bounds (test.type 1, 4, 6), 
but not for 2-sided designs with binding futility bounds (test.type 2, 3 or 5).
Mild restrictions are required on spending functions used, but these are satisfied for commonly used spending functions
such as the Lan-DeMets spending function approximating an O'Brien-Fleming bound or a Hwang-Shih-DeCani spending function; see Maurer and Bretz (2013)." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gsDesign</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.2.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Sequential p-value computation</h1>
    
    <div class="hidden name"><code>sequentiaPValue.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>sequentialPValue</code> computes a sequential p-value for a group sequential design using a spending function as described in 
Maurer and Bretz (2013) and previously defined by Liu and Anderson (2008).
It is the minimum of repeated p-values computed at each analysis (Jennison and Turnbull, 2000).
This is particularly useful for multiplicity methods such as the graphical method for group sequential designs 
where sequential p-values for multiple hypotheses can be used as nominal p-values to plug into a multiplicity graph. 
A sequential p-value is described as the minimum alpha level at which a one-sided group sequential bound would 
be rejected given interim and final observed results.
It is meaningful for both one-sided designs and designs with non-binding futility bounds (<code>test.type</code> 1, 4, 6), 
but not for 2-sided designs with binding futility bounds (<code>test.type</code> 2, 3 or 5).
Mild restrictions are required on spending functions used, but these are satisfied for commonly used spending functions
such as the Lan-DeMets spending function approximating an O'Brien-Fleming bound or a Hwang-Shih-DeCani spending function; see Maurer and Bretz (2013).</p>
    </div>

    <div class="ref-usage sourceCode"><pre class='sourceCode r'><code><span class='fu'>sequentialPValue</span><span class='op'>(</span>
  gsD <span class='op'>=</span> <span class='fu'><a href='gsDesign.html'>gsDesign</a></span><span class='op'>(</span><span class='op'>)</span>,
  n.I <span class='op'>=</span> <span class='cn'>NULL</span>,
  Z <span class='op'>=</span> <span class='cn'>NULL</span>,
  usTime <span class='op'>=</span> <span class='cn'>NULL</span>,
  interval <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1e-05</span>, <span class='fl'>0.9999</span><span class='op'>)</span>
<span class='op'>)</span></code></pre></div>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>gsD</th>
      <td><p>Group sequential design generated by <code>gsDesign</code> or <code>gsSurv</code>.</p></td>
    </tr>
    <tr>
      <th>n.I</th>
      <td><p>Event counts (for time-to-event outcomes) or sample size (for most other designs); numeric vector with increasing, positive values with at most one
value greater than or equal to largest value in <code>gsD$n.I</code>; NOTE: if NULL, planned n.I will be used (<code>gsD$n.I</code>).</p></td>
    </tr>
    <tr>
      <th>Z</th>
      <td><p>Z-value tests corresponding to analyses in <code>n.I</code>; positive values indicate a positive finding; must have the same length as <code>n.I</code>.</p></td>
    </tr>
    <tr>
      <th>usTime</th>
      <td><p>Spending time for upper bound at specified analyses; specify default: <code>NULL</code> if this is to be based on information fraction; 
if not <code>NULL</code>, must have the same length as <code>n.I</code>; increasing positive values with at most 1 greater than or equal to 1.</p></td>
    </tr>
    <tr>
      <th>interval</th>
      <td><p>Interval for search to derive p-value; Default: <code>c(1e-05, 0.9999)</code>. Lower end of interval must be &gt;0 and upper end must be &lt; 1. 
The primary reason to not use the defaults would likely be if a test were vs a Type I error &lt;0.0001.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Sequential p-value (single numeric one-sided p-value between 0 and 1). 
Note that if the sequential p-value is less than the lower end of the input interval, 
the lower of interval will be returned.
Similarly, if the sequential p-value is greater than the upper end of the input interval, 
then the upper end of interval is returned.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Solution is found with a search using <code>uniroot</code>.
This finds the maximum alpha-level for which an efficacy bound is crossed, 
completely ignoring any futility bound.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Jennison C and Turnbull BW (2000), <em>Group Sequential
Methods with Applications to Clinical Trials</em>. Boca Raton: Chapman and Hall.</p>
<p>Liu, Qing, and Keaven M. Anderson. "On adaptive extensions of group sequential trials for clinical investigations." <em>Journal of the American Statistical Association</em> 103.484 (2008): 1621-1630.</p>
<p>Maurer, Willi, and Frank Bretz. "Multiple testing in group sequential trials using graphical approaches." <em>Statistics in Biopharmaceutical Research</em> 5.4 (2013): 311-320.;</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Keaven Anderson</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <div class="ref-examples sourceCode"><pre class='sourceCode r'><code><span class='r-in'></span>
<span class='r-in'><span class='co'># Derive Group Sequential Design </span></span>
<span class='r-in'><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nSurv.html'>gsSurv</a></span><span class='op'>(</span>k <span class='op'>=</span> <span class='fl'>4</span>, alpha <span class='op'>=</span> <span class='fl'>0.025</span>, beta <span class='op'>=</span> <span class='fl'>0.1</span>, timing <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>.5</span>,<span class='fl'>.65</span>,<span class='fl'>.8</span><span class='op'>)</span>, sfu <span class='op'>=</span> <span class='va'>sfLDOF</span>,</span>
<span class='r-in'>            sfl <span class='op'>=</span> <span class='va'>sfHSD</span>, sflpar <span class='op'>=</span> <span class='fl'>2</span>, lambdaC <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>6</span>, hr <span class='op'>=</span> <span class='fl'>0.6</span>,</span>
<span class='r-in'>            eta <span class='op'>=</span> <span class='fl'>0.01</span> , gamma <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2.5</span>,<span class='fl'>5</span>,<span class='fl'>7.5</span>,<span class='fl'>10</span><span class='op'>)</span>, R <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span> <span class='fl'>2</span>,<span class='fl'>2</span>,<span class='fl'>2</span>,<span class='fl'>6</span> <span class='op'>)</span>,</span>
<span class='r-in'>            T <span class='op'>=</span> <span class='fl'>30</span> , minfup <span class='op'>=</span> <span class='fl'>18</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>x</span><span class='op'>$</span><span class='va'>n.I</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 109.2757 142.0585 174.8412 218.5515</span>
<span class='r-in'><span class='co'># Analysis at IA2</span></span>
<span class='r-in'><span class='fu'>sequentialPValue</span><span class='op'>(</span>gsD<span class='op'>=</span><span class='va'>x</span>,n.I<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>100</span>,<span class='fl'>160</span><span class='op'>)</span>,Z<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1.5</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 0.05363369</span>
<span class='r-in'><span class='co'># Use planned spending instead of information fraction; do final analysis</span></span>
<span class='r-in'><span class='fu'>sequentialPValue</span><span class='op'>(</span>gsD<span class='op'>=</span><span class='va'>x</span>,n.I<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>100</span>,<span class='fl'>160</span>,<span class='fl'>190</span>,<span class='fl'>230</span><span class='op'>)</span>,Z<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1.5</span>,<span class='fl'>2</span>,<span class='fl'>2.5</span>,<span class='fl'>3</span><span class='op'>)</span>,usTime<span class='op'>=</span><span class='va'>x</span><span class='op'>$</span><span class='va'>timing</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 0.001452684</span>
<span class='r-in'><span class='co'># Check bounds for updated design to verify at least one was crossed</span></span>
<span class='r-in'><span class='va'>xupdate</span> <span class='op'>&lt;-</span> <span class='fu'><a href='gsDesign.html'>gsDesign</a></span><span class='op'>(</span>maxn.IPlan<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>$</span><span class='va'>n.I</span><span class='op'>)</span>,n.I<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>100</span>,<span class='fl'>160</span>,<span class='fl'>190</span>,<span class='fl'>230</span><span class='op'>)</span>,usTime<span class='op'>=</span><span class='va'>x</span><span class='op'>$</span><span class='va'>timing</span>,</span>
<span class='r-in'>                    delta<span class='op'>=</span><span class='va'>x</span><span class='op'>$</span><span class='va'>delta</span>,delta1<span class='op'>=</span><span class='va'>x</span><span class='op'>$</span><span class='va'>delta1</span>,k<span class='op'>=</span><span class='fl'>4</span>,alpha<span class='op'>=</span><span class='va'>x</span><span class='op'>$</span><span class='va'>alpha</span>,test.type<span class='op'>=</span><span class='fl'>1</span>,</span>
<span class='r-in'>                    sfu<span class='op'>=</span><span class='va'>x</span><span class='op'>$</span><span class='va'>upper</span><span class='op'>$</span><span class='va'>sf</span>,sfupar<span class='op'>=</span><span class='va'>x</span><span class='op'>$</span><span class='va'>upper</span><span class='op'>$</span><span class='va'>param</span><span class='op'>)</span></span>
</code></pre></div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Keaven Anderson.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


