<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Boundary Crossing Probabilities — gsProbability • gsDesign</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Boundary Crossing Probabilities — gsProbability" />
<meta property="og:description" content="Computes power/Type I error and expected sample size for a group sequential
design across a selected set of parameter values for a given set of analyses
and boundaries. The print function has been extended using
print.gsProbability to print gsProbability objects; see
examples.
Depending on the calling sequence, an object of class gsProbability
or class gsDesign is returned. If it is of class gsDesign then
the members of the object will be the same as described in
gsDesign. If d is input as NULL (the default),
all other arguments (other than r) must be specified and an object of
class gsProbability is returned. If d is passed as an object
of class gsProbability or gsDesign the only other argument
required is theta; the object returned has the same class as the
input d. On output, the values of theta input to
gsProbability will be the parameter values for which the design is
characterized." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gsDesign</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.1.9002</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Boundary Crossing Probabilities</h1>
    
    <div class="hidden name"><code>gsProbability.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Computes power/Type I error and expected sample size for a group sequential
design across a selected set of parameter values for a given set of analyses
and boundaries. The print function has been extended using
<code>print.gsProbability</code> to print <code>gsProbability</code> objects; see
examples.</p>
<p>Depending on the calling sequence, an object of class <code>gsProbability</code>
or class <code>gsDesign</code> is returned. If it is of class <code>gsDesign</code> then
the members of the object will be the same as described in
<code><a href='gsDesign.html'>gsDesign</a></code>. If <code>d</code> is input as <code>NULL</code> (the default),
all other arguments (other than <code>r</code>) must be specified and an object of
class <code>gsProbability</code> is returned. If <code>d</code> is passed as an object
of class <code>gsProbability</code> or <code>gsDesign</code> the only other argument
required is <code>theta</code>; the object returned has the same class as the
input <code>d</code>. On output, the values of <code>theta</code> input to
<code>gsProbability</code> will be the parameter values for which the design is
characterized.</p>
    </div>

    <pre class="usage"><span class='fu'>gsProbability</span><span class='op'>(</span>k <span class='op'>=</span> <span class='fl'>0</span>, <span class='va'>theta</span>, <span class='va'>n.I</span>, <span class='va'>a</span>, <span class='va'>b</span>, r <span class='op'>=</span> <span class='fl'>18</span>, d <span class='op'>=</span> <span class='cn'>NULL</span>, overrun <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>

<span class='co'># S3 method for gsProbability</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>k</th>
      <td><p>Number of analyses planned, including interim and final.</p></td>
    </tr>
    <tr>
      <th>theta</th>
      <td><p>Vector of standardized effect sizes for which boundary crossing
probabilities are to be computed.</p></td>
    </tr>
    <tr>
      <th>n.I</th>
      <td><p>Sample size or relative sample size at analyses; vector of length
k. See <code><a href='gsDesign.html'>gsDesign</a></code> and manual.</p></td>
    </tr>
    <tr>
      <th>a</th>
      <td><p>Lower bound cutoffs (z-values) for futility or harm at each
analysis, vector of length k.</p></td>
    </tr>
    <tr>
      <th>b</th>
      <td><p>Upper bound cutoffs (z-values) for futility at each analysis;
vector of length k.</p></td>
    </tr>
    <tr>
      <th>r</th>
      <td><p>Control for grid as in Jennison and Turnbull (2000); default is 18,
range is 1 to 80.  Normally this will not be changed by the user.</p></td>
    </tr>
    <tr>
      <th>d</th>
      <td><p>If not <code>NULL</code>, this should be an object of type
<code>gsDesign</code> returned by a call to <code><a href='gsDesign.html'>gsDesign()</a></code>.  When this is
specified, the values of <code>k</code>, <code>n.I</code>, <code>a</code>, <code>b</code>, and
<code>r</code> will be obtained from <code>d</code> and only <code>theta</code> needs to be
specified by the user.</p></td>
    </tr>
    <tr>
      <th>overrun</th>
      <td><p>Scalar or vector of length <code>k-1</code> with patients enrolled
that are not included in each interim analysis.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>An item of class <code>gsProbability</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Not implemented (here for compatibility with generic print
input).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    

<dt>k</dt><dd><p>As input.</p></dd> <dt>theta</dt><dd><p>As input.</p></dd> <dt>n.I</dt><dd><p>As input.</p></dd>
<dt>lower</dt><dd><p>A list containing two elements: <code>bound</code> is as input in
<code>a</code> and <code>prob</code> is a matrix of boundary crossing probabilities.
Element <code>i,j</code> contains the boundary crossing probability at analysis
<code>i</code> for the <code>j</code>-th element of <code>theta</code> input. All boundary
crossing is assumed to be binding for this computation; that is, the trial
must stop if a boundary is crossed.</p></dd> <dt>upper</dt><dd><p>A list of the same form as
<code>lower</code> containing the upper bound and upper boundary crossing
probabilities.</p></dd> <dt>en</dt><dd><p>A vector of the same length as <code>theta</code>
containing expected sample sizes for the trial design corresponding to each
value in the vector <code>theta</code>.</p></dd> <dt>r</dt><dd><p>As input.</p></dd> Note:
print.gsProbability() returns the input x.

    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>The manual is not linked to this help file, but is available in
library/gsdesign/doc/gsDesignManual.pdf in the directory where R is
installed.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Jennison C and Turnbull BW (2000), <em>Group Sequential
Methods with Applications to Clinical Trials</em>. Boca Raton: Chapman and Hall.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='plot.gsDesign.html'>plot.gsDesign</a>, <code><a href='gsDesign.html'>gsDesign</a></code>,
<a href='gsDesign package overview.html'>gsDesign package overview</a></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Keaven Anderson <a href='mailto:keaven\_anderson@merck.'>keaven\_anderson@merck.</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span>
<span class='co'># making a gsDesign object first may be easiest...</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='gsDesign.html'>gsDesign</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='co'># take a look at it</span>
<span class='va'>x</span>
</div><div class='output co'>#&gt; Asymmetric two-sided group sequential design with
#&gt; 90 % power and 2.5 % Type I Error.
#&gt; Upper bound spending computations assume
#&gt; trial continues if lower bound is crossed.
#&gt; 
#&gt;            Sample
#&gt;             Size    ----Lower bounds----  ----Upper bounds-----
#&gt;   Analysis Ratio*   Z   Nominal p Spend+  Z   Nominal p Spend++
#&gt;          1  0.357 -0.24    0.4057 0.0148 3.01    0.0013  0.0013
#&gt;          2  0.713  0.94    0.8267 0.0289 2.55    0.0054  0.0049
#&gt;          3  1.070  2.00    0.9772 0.0563 2.00    0.0228  0.0188
#&gt;      Total                        0.1000                 0.0250 
#&gt; + lower bound beta spending (under H1):
#&gt;  Hwang-Shih-DeCani spending function with gamma = -2.
#&gt; ++ alpha spending:
#&gt;  Hwang-Shih-DeCani spending function with gamma = -4.
#&gt; * Sample size ratio compared to fixed design with no interim
#&gt; 
#&gt; Boundary crossing probabilities and expected sample size
#&gt; assume any cross stops the trial
#&gt; 
#&gt; Upper boundary (power or Type I Error)
#&gt;           Analysis
#&gt;    Theta      1      2      3  Total   E{N}
#&gt;   0.0000 0.0013 0.0049 0.0171 0.0233 0.6249
#&gt;   3.2415 0.1412 0.4403 0.3185 0.9000 0.7913
#&gt; 
#&gt; Lower boundary (futility or Type II Error)
#&gt;           Analysis
#&gt;    Theta      1      2      3  Total
#&gt;   0.0000 0.4057 0.4290 0.1420 0.9767
#&gt;   3.2415 0.0148 0.0289 0.0563 0.1000</div><div class='input'>
<span class='co'># default plot for gsDesign object shows boundaries</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
</div><div class='img'><img src='gsProbability-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># plottype=2 shows boundary crossing probabilities</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>x</span>, plottype <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</div><div class='img'><img src='gsProbability-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># now add boundary crossing probabilities and</span>
<span class='co'># expected sample size for more theta values</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'>gsProbability</span><span class='op'>(</span>d <span class='op'>=</span> <span class='va'>x</span>, theta <span class='op'>=</span> <span class='va'>x</span><span class='op'>$</span><span class='va'>delta</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>2</span>, <span class='fl'>.25</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] "gsDesign"</div><div class='input'>
<span class='co'># note that "y" below is equivalent to print(y) and</span>
<span class='co'># print.gsProbability(y)</span>
<span class='va'>y</span>
</div><div class='output co'>#&gt; Asymmetric two-sided group sequential design with
#&gt; 90 % power and 2.5 % Type I Error.
#&gt; Upper bound spending computations assume
#&gt; trial continues if lower bound is crossed.
#&gt; 
#&gt;            Sample
#&gt;             Size    ----Lower bounds----  ----Upper bounds-----
#&gt;   Analysis Ratio*   Z   Nominal p Spend+  Z   Nominal p Spend++
#&gt;          1  0.357 -0.24    0.4057 0.0148 3.01    0.0013  0.0013
#&gt;          2  0.713  0.94    0.8267 0.0289 2.55    0.0054  0.0049
#&gt;          3  1.070  2.00    0.9772 0.0563 2.00    0.0228  0.0188
#&gt;      Total                        0.1000                 0.0250 
#&gt; + lower bound beta spending (under H1):
#&gt;  Hwang-Shih-DeCani spending function with gamma = -2.
#&gt; ++ alpha spending:
#&gt;  Hwang-Shih-DeCani spending function with gamma = -4.
#&gt; * Sample size ratio compared to fixed design with no interim
#&gt; 
#&gt; Boundary crossing probabilities and expected sample size
#&gt; assume any cross stops the trial
#&gt; 
#&gt; Upper boundary (power or Type I Error)
#&gt;           Analysis
#&gt;    Theta      1      2      3  Total   E{N}
#&gt;   0.0000 0.0013 0.0049 0.0171 0.0233 0.6249
#&gt;   0.8104 0.0058 0.0279 0.0872 0.1209 0.7523
#&gt;   1.6208 0.0205 0.1038 0.2393 0.3636 0.8520
#&gt;   2.4311 0.0595 0.2579 0.3636 0.6810 0.8668
#&gt;   3.2415 0.1412 0.4403 0.3185 0.9000 0.7913
#&gt;   4.0519 0.2773 0.5353 0.1684 0.9810 0.6765
#&gt;   4.8623 0.4574 0.4844 0.0559 0.9976 0.5701
#&gt;   5.6727 0.6469 0.3410 0.0119 0.9998 0.4868
#&gt;   6.4830 0.8053 0.1930 0.0016 1.0000 0.4266
#&gt; 
#&gt; Lower boundary (futility or Type II Error)
#&gt;           Analysis
#&gt;    Theta      1      2      3  Total
#&gt;   0.0000 0.4057 0.4290 0.1420 0.9767
#&gt;   0.8104 0.2349 0.3812 0.2630 0.8791
#&gt;   1.6208 0.1138 0.2385 0.2841 0.6364
#&gt;   2.4311 0.0455 0.1017 0.1718 0.3190
#&gt;   3.2415 0.0148 0.0289 0.0563 0.1000
#&gt;   4.0519 0.0039 0.0054 0.0097 0.0190
#&gt;   4.8623 0.0008 0.0006 0.0009 0.0024
#&gt;   5.6727 0.0001 0.0001 0.0000 0.0002
#&gt;   6.4830 0.0000 0.0000 0.0000 0.0000</div><div class='input'>
<span class='co'># the plot does not change from before since this is a</span>
<span class='co'># gsDesign object; note that theta/delta is on x axis</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>y</span>, plottype <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</div><div class='img'><img src='gsProbability-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># now let's see what happens with a gsProbability object</span>
<span class='va'>z</span> <span class='op'>&lt;-</span> <span class='fu'>gsProbability</span><span class='op'>(</span>
  k <span class='op'>=</span> <span class='fl'>3</span>, a <span class='op'>=</span> <span class='va'>x</span><span class='op'>$</span><span class='va'>lower</span><span class='op'>$</span><span class='va'>bound</span>, b <span class='op'>=</span> <span class='va'>x</span><span class='op'>$</span><span class='va'>upper</span><span class='op'>$</span><span class='va'>bound</span>,
  n.I <span class='op'>=</span> <span class='va'>x</span><span class='op'>$</span><span class='va'>n.I</span>, theta <span class='op'>=</span> <span class='va'>x</span><span class='op'>$</span><span class='va'>delta</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>2</span>, <span class='fl'>.25</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='co'># with the above form,  the results is a gsProbability object</span>
<span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span><span class='op'>(</span><span class='va'>z</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] "gsProbability"</div><div class='input'><span class='va'>z</span>
</div><div class='output co'>#&gt;               Lower bounds   Upper bounds
#&gt;   Analysis N    Z   Nominal p  Z   Nominal p
#&gt;          1  1 -0.24    0.4057 3.01    0.0013
#&gt;          2  1  0.94    0.8267 2.55    0.0054
#&gt;          3  2  2.00    0.9772 2.00    0.0228
#&gt; 
#&gt; Boundary crossing probabilities and expected sample size assume
#&gt; any cross stops the trial
#&gt; 
#&gt; Upper boundary (power or Type I Error)
#&gt;           Analysis
#&gt;    Theta      1      2      3  Total E{N}
#&gt;   0.0000 0.0013 0.0049 0.0171 0.0233  0.6
#&gt;   0.8104 0.0058 0.0279 0.0872 0.1209  0.8
#&gt;   1.6208 0.0205 0.1038 0.2393 0.3636  0.9
#&gt;   2.4311 0.0595 0.2579 0.3636 0.6810  0.9
#&gt;   3.2415 0.1412 0.4403 0.3185 0.9000  0.8
#&gt;   4.0519 0.2773 0.5353 0.1684 0.9810  0.7
#&gt;   4.8623 0.4574 0.4844 0.0559 0.9976  0.6
#&gt;   5.6727 0.6469 0.3410 0.0119 0.9998  0.5
#&gt;   6.4830 0.8053 0.1930 0.0016 1.0000  0.4
#&gt; 
#&gt; Lower boundary (futility or Type II Error)
#&gt;           Analysis
#&gt;    Theta      1      2      3  Total
#&gt;   0.0000 0.4057 0.4290 0.1420 0.9767
#&gt;   0.8104 0.2349 0.3812 0.2630 0.8791
#&gt;   1.6208 0.1138 0.2385 0.2841 0.6364
#&gt;   2.4311 0.0455 0.1017 0.1718 0.3190
#&gt;   3.2415 0.0148 0.0289 0.0563 0.1000
#&gt;   4.0519 0.0039 0.0054 0.0097 0.0190
#&gt;   4.8623 0.0008 0.0006 0.0009 0.0024
#&gt;   5.6727 0.0001 0.0001 0.0000 0.0002
#&gt;   6.4830 0.0000 0.0000 0.0000 0.0000</div><div class='input'>
<span class='co'># default plottype is now 2</span>
<span class='co'># this is the same range for theta, but plot now has theta on x axis</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>z</span><span class='op'>)</span>
</div><div class='img'><img src='gsProbability-4.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Keaven Anderson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


