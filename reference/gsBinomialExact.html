<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>One-Sample Binomial Routines — gsBinomialExact • gsDesign</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="One-Sample Binomial Routines — gsBinomialExact" />
<meta property="og:description" content="gsBinomialExact computes power/Type I error and expected sample size
for a group sequential design in a single-arm trial with a binary outcome.
This can also be used to compare event rates in two-arm studies. The print
function has been extended using print.gsBinomialExact to print
gsBinomialExact objects. Similarly, a plot function has
been extended using plot.gsBinomialExact to plot
gsBinomialExact objects.
binomialSPRT computes a truncated binomial sequential probability
ratio test (SPRT) which is a specific instance of an exact binomial group
sequential design for a single arm trial with a binary outcome.

based on predictive probability.
nBinomial1Sample uses exact binomial calculations to compute power
and sample size for single arm binomial experiments.
gsBinomialExact is based on the book &quot;Group Sequential Methods with
Applications to Clinical Trials,&quot; Christopher Jennison and Bruce W.
Turnbull, Chapter 12, Section 12.1.2 Exact Calculations for Binary Data.
This computation is often used as an approximation for the distribution of
the number of events in one treatment group out of all events when the
probability of an event is small and sample size is large.
An object of class gsBinomialExact is returned. On output, the values
of theta input to gsBinomialExact will be the parameter values
for which the boundary crossing probabilities and expected sample sizes are
computed.
Note that a[1] equal to -1 lower bound at n.I[1] means 0 successes continues
at interim 1; a[2]==0 at interim 2 means 0 successes stops trial for
futility at 2nd analysis.  For final analysis, set a[k] equal to b[k]-1 to
incorporate all possibilities into non-positive trial; see example.
The sequential probability ratio test (SPRT) is a sequential testing scheme
allowing testing after each observation. This likelihood ratio is used to
determine upper and lower cutoffs which are linear and parallel in the
number of responses as a function of sample size.  binomialSPRT
produces a variation the the SPRT that tests only within a range of sample
sizes. While the linear SPRT bounds are continuous, actual bounds are the
integer number of response at or beyond each linear bound for each sample
size where testing is performed. Because of the truncation and
discretization of the bounds, power and Type I error achieve will be lower
than the nominal levels specified by alpha and beta which can
be altered to produce desired values that are achieved by the planned sample
size. See also example that shows computation of Type I error when futility
bound is considered non-binding.
Note that if the objective of a design is to demonstrate that a rate (e.g.,
failure rate) is lower than a certain level, two approaches can be taken.
First, 1 minus the failure rate is the success rate and this can be used for
planning. Second, the role of beta becomes to express Type I error
and alpha is used to express Type II error.
Plots produced include boundary plots, expected sample size, response rate
at the boundary and power.
gsBinomial1Sample uses exact binomial computations based on the base
R functions qbinom() and pbinom(). The tabular output may be
convenient for plotting. Note that input variables are largely not checked,
so the user is largely responsible for results; it is a good idea to do a
run with outtype=3 to check that you have done things appropriately.
If n is not ordered (a bad idea) or not sequential (maybe OK), be
aware of possible consequences.
nBinomial1Sample is based on code from Marc Schwartz marc_schwartz@me.com. 
The possible sample size vector n needs to be selected in such a fashion
that it covers the possible range of values that include the true minima. 
NOTE: the one-sided evaluation of significance is more conservative than using the 2-sided exact test in binom.test." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gsDesign</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>One-Sample Binomial Routines</h1>
    
    <div class="hidden name"><code>gsBinomialExact.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>gsBinomialExact</code> computes power/Type I error and expected sample size
for a group sequential design in a single-arm trial with a binary outcome.
This can also be used to compare event rates in two-arm studies. The print
function has been extended using <code>print.gsBinomialExact</code> to print
<code>gsBinomialExact</code> objects. Similarly, a plot function has
been extended using <code>plot.gsBinomialExact</code> to plot
<code>gsBinomialExact</code> objects.</p>
<p><code>binomialSPRT</code> computes a truncated binomial sequential probability
ratio test (SPRT) which is a specific instance of an exact binomial group
sequential design for a single arm trial with a binary outcome.</p>
<p><!-- %\code{gsBinomialPP} computes a truncated binomial (group) sequential design -->
based on predictive probability.</p>
<p><code>nBinomial1Sample</code> uses exact binomial calculations to compute power
and sample size for single arm binomial experiments.</p>
<p><code>gsBinomialExact</code> is based on the book "Group Sequential Methods with
Applications to Clinical Trials," Christopher Jennison and Bruce W.
Turnbull, Chapter 12, Section 12.1.2 Exact Calculations for Binary Data.
This computation is often used as an approximation for the distribution of
the number of events in one treatment group out of all events when the
probability of an event is small and sample size is large.</p>
<p>An object of class <code>gsBinomialExact</code> is returned. On output, the values
of <code>theta</code> input to <code>gsBinomialExact</code> will be the parameter values
for which the boundary crossing probabilities and expected sample sizes are
computed.</p>
<p>Note that a[1] equal to -1 lower bound at n.I[1] means 0 successes continues
at interim 1; a[2]==0 at interim 2 means 0 successes stops trial for
futility at 2nd analysis.  For final analysis, set a[k] equal to b[k]-1 to
incorporate all possibilities into non-positive trial; see example.</p>
<p>The sequential probability ratio test (SPRT) is a sequential testing scheme
allowing testing after each observation. This likelihood ratio is used to
determine upper and lower cutoffs which are linear and parallel in the
number of responses as a function of sample size.  <code>binomialSPRT</code>
produces a variation the the SPRT that tests only within a range of sample
sizes. While the linear SPRT bounds are continuous, actual bounds are the
integer number of response at or beyond each linear bound for each sample
size where testing is performed. Because of the truncation and
discretization of the bounds, power and Type I error achieve will be lower
than the nominal levels specified by <code>alpha</code> and <code>beta</code> which can
be altered to produce desired values that are achieved by the planned sample
size. See also example that shows computation of Type I error when futility
bound is considered non-binding.</p>
<p>Note that if the objective of a design is to demonstrate that a rate (e.g.,
failure rate) is lower than a certain level, two approaches can be taken.
First, 1 minus the failure rate is the success rate and this can be used for
planning. Second, the role of <code>beta</code> becomes to express Type I error
and <code>alpha</code> is used to express Type II error.</p>
<p>Plots produced include boundary plots, expected sample size, response rate
at the boundary and power.</p>
<p><code>gsBinomial1Sample</code> uses exact binomial computations based on the base
R functions <code><a href='https://rdrr.io/r/stats/Binomial.html'>qbinom()</a></code> and <code><a href='https://rdrr.io/r/stats/Binomial.html'>pbinom()</a></code>. The tabular output may be
convenient for plotting. Note that input variables are largely not checked,
so the user is largely responsible for results; it is a good idea to do a
run with <code>outtype=3</code> to check that you have done things appropriately.
If <code>n</code> is not ordered (a bad idea) or not sequential (maybe OK), be
aware of possible consequences.</p>
<p><code>nBinomial1Sample</code> is based on code from Marc Schwartz marc_schwartz@me.com. 
The possible sample size vector <code>n</code> needs to be selected in such a fashion
that it covers the possible range of values that include the true minima. 
NOTE: the one-sided evaluation of significance is more conservative than using the 2-sided exact test in <code>binom.test</code>.</p>
    </div>

    <pre class="usage"><span class='fu'>gsBinomialExact</span><span class='op'>(</span>
  k <span class='op'>=</span> <span class='fl'>2</span>,
  theta <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>0.2</span><span class='op'>)</span>,
  n.I <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>50</span>, <span class='fl'>100</span><span class='op'>)</span>,
  a <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>, <span class='fl'>7</span><span class='op'>)</span>,
  b <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>20</span>, <span class='fl'>30</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='fu'>binomialSPRT</span><span class='op'>(</span>
  p0 <span class='op'>=</span> <span class='fl'>0.05</span>,
  p1 <span class='op'>=</span> <span class='fl'>0.25</span>,
  alpha <span class='op'>=</span> <span class='fl'>0.1</span>,
  beta <span class='op'>=</span> <span class='fl'>0.15</span>,
  minn <span class='op'>=</span> <span class='fl'>10</span>,
  maxn <span class='op'>=</span> <span class='fl'>35</span>
<span class='op'>)</span>

<span class='co'># S3 method for gsBinomialExact</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>x</span>, plottype <span class='op'>=</span> <span class='fl'>1</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='fu'>nBinomial1Sample</span><span class='op'>(</span>
  p0 <span class='op'>=</span> <span class='fl'>0.9</span>,
  p1 <span class='op'>=</span> <span class='fl'>0.95</span>,
  alpha <span class='op'>=</span> <span class='fl'>0.025</span>,
  beta <span class='op'>=</span> <span class='cn'>NULL</span>,
  n <span class='op'>=</span> <span class='fl'>200</span><span class='op'>:</span><span class='fl'>250</span>,
  outtype <span class='op'>=</span> <span class='fl'>1</span>,
  conservative <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>k</th>
      <td><p>Number of analyses planned, including interim and final.</p></td>
    </tr>
    <tr>
      <th>theta</th>
      <td><p>Vector of possible underling binomial probabilities for a
single binomial sample.</p></td>
    </tr>
    <tr>
      <th>n.I</th>
      <td><p>Sample size at analyses (increasing positive integers); vector of
length k.</p></td>
    </tr>
    <tr>
      <th>a</th>
      <td><p>Number of "successes" required to cross lower bound cutoffs to
reject <code>p1</code> in favor of <code>p0</code> at each analysis; vector of length k;
-1 means no lower bound.</p></td>
    </tr>
    <tr>
      <th>b</th>
      <td><p>Number of "successes" required to cross upper bound cutoffs for
rejecting <code>p0</code> in favor of <code>p1</code> at each analysis; vector of length
k.</p></td>
    </tr>
    <tr>
      <th>p0</th>
      <td><p>Lower of the two response (event) rates hypothesized.</p></td>
    </tr>
    <tr>
      <th>p1</th>
      <td><p>Higher of the two response (event) rates hypothesized.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>Nominal probability of rejecting response (event) rate
<code>p0</code> when it is true.</p></td>
    </tr>
    <tr>
      <th>beta</th>
      <td><p>Nominal probability of rejecting response (event) rate <code>p1</code>
when it is true. If NULL, Type II error will be computed for all input values 
of <code>n</code> and output will be in a data frame.</p></td>
    </tr>
    <tr>
      <th>minn</th>
      <td><p>Minimum sample size at which sequential testing begins.</p></td>
    </tr>
    <tr>
      <th>maxn</th>
      <td><p>Maximum sample size.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>Item of class <code>gsBinomialExact</code> or <code>binomialSPRT</code> for
<code>print.gsBinomialExact</code>. Item of class <code>gsBinomialExact</code> for
<code>plot.gsBinomialExact</code>. Item of class <code>binomialSPRT</code> for item of
class <code>binomialSPRT</code>.</p></td>
    </tr>
    <tr>
      <th>plottype</th>
      <td><p>1 produces a plot with counts of response at bounds (for
<code>binomialSPRT</code>, also produces linear SPRT bounds); 2 produces a plot
with power to reject null and alternate response rates as well as the
probability of not crossing a bound by the maximum sample size; 3 produces a
plot with the response rate at the boundary as a function of sample size
when the boundary is crossed; 6 produces a plot of the expected sample size
by the underlying event rate (this assumes there is no enrollment beyond the
sample size where the boundary is crossed).</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>arguments passed through to <code>ggplot</code>.</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>sample sizes to be considered for <code>nBinomial1Sample</code>. These
should be ordered from smallest to largest and be &gt; 0.</p></td>
    </tr>
    <tr>
      <th>outtype</th>
      <td><p>Operative when <code>beta != NULL</code>. <code>1</code> means routine
will return a single integer sample size while for <code>output=2</code>a data frame 
is returned (see Value); note that this not operative is <code>beta</code> is <code>NULL</code> 
in which case a data table is returned with Type II error and power for each input 
value of <code>n</code>.</p></td>
    </tr>
    <tr>
      <th>conservative</th>
      <td><p>operative when <code>outtype=1</code> or <code>2</code> and
<code>beta != NULL</code>. Default <code>FALSE</code> selects minimum sample size for
which power is at least <code>1-beta</code>. When <code>conservative=TRUE</code>, the
minimum sample sample size for which power is at least <code>1-beta</code> and
there is no larger sample size in the input <code>n</code> where power is less
than <code>1-beta</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>gsBinomialExact()</code> returns a list of class
<code>gsBinomialExact</code> and <code>gsProbability</code> (see example); when
displaying one of these objects, the default function to print is
<code><a href='gsProbability.html'>print.gsProbability()</a></code>.  The object returned from
<code>gsBinomialExact()</code> contains the following elements:</p>
<dt>k</dt><dd><p>As
input.</p></dd> <dt>theta</dt><dd><p>As input.</p></dd> <dt>n.I</dt><dd><p>As input.</p></dd> <dt>lower</dt><dd><p>A list
containing two elements: <code>bound</code> is as input in <code>a</code> and
<code>prob</code> is a matrix of boundary crossing probabilities. Element
<code>i,j</code> contains the boundary crossing probability at analysis <code>i</code>
for the <code>j</code>-th element of <code>theta</code> input. All boundary crossing is
assumed to be binding for this computation; that is, the trial must stop if
a boundary is crossed.</p></dd> <dt>upper</dt><dd><p>A list of the same form as <code>lower</code>
containing the upper bound and upper boundary crossing probabilities.</p></dd>
<dt>en</dt><dd><p>A vector of the same length as <code>theta</code> containing expected
sample sizes for the trial design corresponding to each value in the vector
<code>theta</code>.</p></dd>

binomialSPRT produces an object of class binomialSPRT that is
an extension of the gsBinomialExact class. The values returned in
addition to those returned by gsBinomialExact are: <dt>intercept</dt><dd><p>A
vector of length 2 with the intercepts for the two SPRT bounds.</p></dd>
<dt>slope</dt><dd><p>A scalar with the common slope of the SPRT bounds.</p></dd>
<dt>alpha</dt><dd><p>As input. Note that this will exceed the actual Type I error
achieved by the design returned.</p></dd> <dt>beta</dt><dd><p>As input. Note that this will
exceed the actual Type II error achieved by the design returned.</p></dd>
<dt>p0</dt><dd><p>As input.</p></dd> <dt>p1</dt><dd><p>As input.</p></dd>

nBinomial1Sample produces a data frame with power for each input value in n 
if beta=NULL. Otherwise, a sample size achieving the desired power is returned unless 
the minimum power for the values input in n is greater than or equal to the target or 
the maximum yields power less than the target, in which case an error message is shown. 
The input variable outtype has no effect if beta=NULL. 
Otherwise, outtype=1 results in return of an integer sample size and outtype=2 
results in a data frame with one record which includes the desired sample size.
When a data frame is returned, the variables include: <dt>p0</dt><dd><p>Input null
hypothesis event (or response) rate.</p></dd> <dt>p1</dt><dd><p>Input alternative hypothesis
(or response) rate; must be <code>&gt; p0</code>.</p></dd> <dt>alpha</dt><dd><p>Input Type I error.</p></dd>
<dt>beta</dt><dd><p>Input Type II error except when input is <code>NULL</code> in which
case realized Type II error is computed.</p></dd> <dt>n</dt><dd><p>sample size.</p></dd> <dt>b</dt><dd><p>cutoff given <code>n</code> to control
Type I error; value is <code>NULL</code> if no such value exists.</p></dd> <dt>alphaR</dt><dd><p>Type I error achieved for each 
output value of <code>n</code>; less than or equal to the input value <code>alpha</code>.</p></dd> <dt>Power</dt><dd><p>Power achieved 
for each output value of <code>n</code>.</p></dd>

    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>The manual is not linked to this help file, but is available in
library/gsdesign/doc/gsDesignManual.pdf in the directory where R is
installed.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Jennison C and Turnbull BW (2000), <em>Group Sequential
Methods with Applications to Clinical Trials</em>. Boca Raton: Chapman and Hall.</p>
<p>Code for nBinomial1Sample was based on code developed by
marc_schwartz@me.com.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='gsProbability.html'>gsProbability</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Jon Hartzel, Yevgen Tymofyeyev and Keaven Anderson <a href='mailto:keaven\_anderson@merck.'>keaven\_anderson@merck.</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span>

<span class='va'>zz</span> <span class='op'>&lt;-</span> <span class='fu'>gsBinomialExact</span><span class='op'>(</span>
  k <span class='op'>=</span> <span class='fl'>3</span>, theta <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0.1</span><span class='op'>)</span>, n.I <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>12</span>, <span class='fl'>24</span>, <span class='fl'>36</span><span class='op'>)</span>,
  a <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>11</span><span class='op'>)</span>, b <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>, <span class='fl'>9</span>, <span class='fl'>12</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='co'># let's see what class this is</span>
<span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span><span class='op'>(</span><span class='va'>zz</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] "gsBinomialExact" "gsProbability"  </div><div class='input'>
<span class='co'># because of "gsProbability" class above, following is equivalent to</span>
<span class='co'># print.gsProbability(zz)</span>
<span class='va'>zz</span>
</div><div class='output co'>#&gt;               Bounds
#&gt;   Analysis   N   a   b
#&gt;          1  12  -1   5
#&gt;          2  24   0   9
#&gt;          3  36  11  12
#&gt; 
#&gt; Boundary crossing probabilities and expected sample size assume
#&gt; any cross stops the trial
#&gt; 
#&gt; Upper boundary (power or Type I Error)
#&gt;           Analysis
#&gt;   Theta      1      2      3  Total E{N}
#&gt;     0.0 0.0000 0.0000 0.0000 0.0000 24.0
#&gt;     0.1 0.0043 0.0002 0.0001 0.0045 34.9
#&gt;     0.2 0.0726 0.0155 0.0168 0.1048 34.0
#&gt;     0.3 0.2763 0.0993 0.1164 0.4921 28.2
#&gt;     0.4 0.5618 0.1782 0.1362 0.8762 20.4
#&gt;     0.5 0.8062 0.1372 0.0463 0.9896 15.0
#&gt;     0.6 0.9427 0.0519 0.0052 0.9998 12.8
#&gt;     0.7 0.9905 0.0093 0.0002 1.0000 12.1
#&gt;     0.8 0.9994 0.0006 0.0000 1.0000 12.0
#&gt;     0.9 1.0000 0.0000 0.0000 1.0000 12.0
#&gt;     1.0 1.0000 0.0000 0.0000 1.0000 12.0
#&gt; 
#&gt; Lower boundary (futility or Type II Error)
#&gt;           Analysis
#&gt;   Theta 1      2      3  Total
#&gt;     0.0 0 1.0000 0.0000 1.0000
#&gt;     0.1 0 0.0798 0.9157 0.9955
#&gt;     0.2 0 0.0047 0.8905 0.8952
#&gt;     0.3 0 0.0002 0.5077 0.5079
#&gt;     0.4 0 0.0000 0.1238 0.1238
#&gt;     0.5 0 0.0000 0.0104 0.0104
#&gt;     0.6 0 0.0000 0.0002 0.0002
#&gt;     0.7 0 0.0000 0.0000 0.0000
#&gt;     0.8 0 0.0000 0.0000 0.0000
#&gt;     0.9 0 0.0000 0.0000 0.0000
#&gt;     1.0 0 0.0000 0.0000 0.0000</div><div class='input'><span class='co'># also plot (see also plots below for \code{binomialSPRT})</span>
<span class='co'># add lines using geom_line()</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>zz</span><span class='op'>)</span> <span class='op'>+</span> 
<span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='op'>)</span>
</div><div class='img'><img src='gsBinomialExact-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># now for SPRT examples</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'>binomialSPRT</span><span class='op'>(</span>p0 <span class='op'>=</span> <span class='fl'>.05</span>, p1 <span class='op'>=</span> <span class='fl'>.25</span>, alpha <span class='op'>=</span> <span class='fl'>.1</span>, beta <span class='op'>=</span> <span class='fl'>.2</span><span class='op'>)</span>
<span class='co'># boundary plot</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
</div><div class='img'><img src='gsBinomialExact-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># power plot</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>x</span>, plottype <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</div><div class='img'><img src='gsBinomialExact-3.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># Response (event) rate at boundary</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>x</span>, plottype <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
</div><div class='img'><img src='gsBinomialExact-4.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># Expected sample size at boundary crossing or end of trial</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>x</span>, plottype <span class='op'>=</span> <span class='fl'>6</span><span class='op'>)</span>
</div><div class='img'><img src='gsBinomialExact-5.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># sample size for single arm exact binomial</span>

<span class='co'># plot of table of power by sample size</span>
<span class='co'># note that outtype need no be specified if beta is NULL</span>
<span class='va'>nb1</span> <span class='op'>&lt;-</span> <span class='fu'>nBinomial1Sample</span><span class='op'>(</span>p0 <span class='op'>=</span> <span class='fl'>0.05</span>, p1<span class='op'>=</span><span class='fl'>0.2</span>,alpha <span class='op'>=</span> <span class='fl'>0.025</span>, beta<span class='op'>=</span><span class='cn'>NULL</span>, n <span class='op'>=</span> <span class='fl'>25</span><span class='op'>:</span><span class='fl'>40</span><span class='op'>)</span>
<span class='va'>nb1</span>
</div><div class='output co'>#&gt;      p0  p1 alpha      beta  n b      alphaR     Power
#&gt; 1  0.05 0.2 0.025 0.4206743 25 5 0.007164948 0.5793257
#&gt; 2  0.05 0.2 0.025 0.3833381 26 5 0.008511231 0.6166619
#&gt; 3  0.05 0.2 0.025 0.3480384 27 5 0.010022739 0.6519616
#&gt; 4  0.05 0.2 0.025 0.3148874 28 5 0.011708399 0.6851126
#&gt; 5  0.05 0.2 0.025 0.2839465 29 5 0.013576673 0.7160535
#&gt; 6  0.05 0.2 0.025 0.2552333 30 5 0.015635510 0.7447667
#&gt; 7  0.05 0.2 0.025 0.2287288 31 5 0.017892313 0.7712712
#&gt; 8  0.05 0.2 0.025 0.2043839 32 5 0.020353899 0.7956161
#&gt; 9  0.05 0.2 0.025 0.1821257 33 5 0.023026479 0.8178743
#&gt; 10 0.05 0.2 0.025 0.2996488 34 6 0.006269405 0.7003512
#&gt; 11 0.05 0.2 0.025 0.2720917 35 6 0.007251716 0.7279083
#&gt; 12 0.05 0.2 0.025 0.2463717 36 6 0.008340444 0.7536283
#&gt; 13 0.05 0.2 0.025 0.2224770 37 6 0.009541557 0.7775230
#&gt; 14 0.05 0.2 0.025 0.2003744 38 6 0.010860905 0.7996256
#&gt; 15 0.05 0.2 0.025 0.1800132 39 6 0.012304191 0.8199868
#&gt; 16 0.05 0.2 0.025 0.1613288 40 6 0.013876949 0.8386712</div><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://scales.r-lib.org'>scales</a></span><span class='op'>)</span>
<span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>nb1</span>, <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>n</span>, y <span class='op'>=</span> <span class='va'>Power</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
<span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> 
<span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> 
<span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>labels <span class='op'>=</span> <span class='va'>percent</span><span class='op'>)</span>
</div><div class='img'><img src='gsBinomialExact-6.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># simple call with same parameters to get minimum sample size yielding desired power</span>
<span class='fu'>nBinomial1Sample</span><span class='op'>(</span>p0 <span class='op'>=</span> <span class='fl'>0.05</span>, p1 <span class='op'>=</span> <span class='fl'>0.2</span>, alpha <span class='op'>=</span> <span class='fl'>0.025</span>, beta <span class='op'>=</span> <span class='fl'>.2</span>, n <span class='op'>=</span> <span class='fl'>25</span><span class='op'>:</span><span class='fl'>40</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 33</div><div class='input'>
<span class='co'># change to 'conservative' if you want all larger sample</span>
<span class='co'># sizes to also provide adequate power</span>
<span class='fu'>nBinomial1Sample</span><span class='op'>(</span>p0 <span class='op'>=</span> <span class='fl'>0.05</span>, p1 <span class='op'>=</span> <span class='fl'>0.2</span>, alpha <span class='op'>=</span> <span class='fl'>0.025</span>, beta <span class='op'>=</span> <span class='fl'>.2</span>, n <span class='op'>=</span> <span class='fl'>25</span><span class='op'>:</span><span class='fl'>40</span>, conservative <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 39</div><div class='input'>
<span class='co'># print out more information for the selected derived sample size</span>
<span class='fu'>nBinomial1Sample</span><span class='op'>(</span>p0 <span class='op'>=</span> <span class='fl'>0.05</span>, p1 <span class='op'>=</span> <span class='fl'>0.2</span>, alpha <span class='op'>=</span> <span class='fl'>0.025</span>, beta <span class='op'>=</span> <span class='fl'>.2</span>, n <span class='op'>=</span> <span class='fl'>25</span><span class='op'>:</span><span class='fl'>40</span>, conservative <span class='op'>=</span> <span class='cn'>TRUE</span>,
 outtype <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</div><div class='output co'>#&gt;     p0  p1 alpha beta  n b     alphaR     Power
#&gt; 1 0.05 0.2 0.025  0.2 39 6 0.01230419 0.8199868</div><div class='input'>
<span class='co'># what happens if input sample sizes not sufficient?</span>
<span class='co'># nBinomial1Sample(p0 = 0.05, p1 = 0.2, alpha = 0.025, beta = .2, n = 25:30)</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Keaven Anderson.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9000.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


